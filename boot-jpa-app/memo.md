## 준영속 엔티티
- detach 이외에도 식별자(id)를 가지고 있지만 영속성 컨텍스트에 포함되지 않은 엔티티이다.
- update등과 같이 이미 db에 정보가 있는 데이터가 그것이다.

## 준영속 엔티티의 변경
- 변경감지
  - id를 통해 다시 find하여 영속성 컨텍스트에 포함시킨 후 값을 변경하여 더티체킹을 이용한다.
- 병합
  - 준영속 상태의 엔티티를 영속성컨텍스트에 포함시켜주는 역할을 한다.
  - 결국 자동으로 변경감지를 위한 find, set등을 진행해준다. (수동으로 변경감지를 이용하려던 것을 자동으로 해준다.)
    - 모든 속성이 변경된다.(주의!!!)
    - 만약 값이 없는 칼럼에 대해서 null로 세팅될 가능성이 있다.(주의!!!)
  - merge의 파라미터로 넘기는 값은 영속성 컨텍스트에 관리되지 않는다.
  - merge의 리턴값이 영속성 컨텍스트에 관리된다.
  - 왠만하면 변경감지를 이용하는 방식으로(수동) 사용하는것이 좋다.(merge 를 쓰지 않는 방향으로)

## select 팁
- ToOne 관계는 무조건 fetch join 을 사용하라
- 컬렉션은 지연로딩으로 조회하라
- 지연 로딩 성능 최적화를 위해 hibernate.default_batch_fetch_size, @BatchSize 를 적용하라
  - 이 옵션을 적용하면 N+1 문제가 발생하는 쿼리를 한방에 가져오도록 변경된다.(N+1 을 1+1 쿼리로, N+M+1 쿼리를 1+1+1쿼리로)
